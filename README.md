

![](https://framerusercontent.com/images/7deg2TItLWZigrN1ZkirE44PXak.png)
# DynaVest 
> Your Cross-Chain DeFi Agent - Bridging Polkadot and EVM Ecosystems

**DynaVest** is an intelligent DeFi investment platform that serves as your personal **"DeFAI Agent"** - a fully autonomous, cross-chain system designed to execute, optimize, and adapt DeFi strategies across **Polkadot** and **EVM networks**. With an intuitive chat interface and advanced AI guidance, it empowers you to interact effortlessly with DeFi protocols while staying up-to-date on the latest trends and insights in real time.

## ğŸŒŸ **Cross-Chain DeFi Agent Architecture**

DynaVest operates as a **unified DeFi Agent** that seamlessly bridges multiple ecosystems:

### ğŸ”— **Polkadot Ecosystem Integration**
- **ğŸ¦€ ink! Smart Contracts**: Native Rust contracts for strategy storage and execution
- **ğŸŒ Substrate Integration**: Direct interaction with Polkadot parachains
- **ğŸ’ Acala & Bifrost**: Liquid staking and DeFi protocols
- **ğŸ”„ HydraDX**: Cross-chain liquidity and omnipool trading
- **ğŸŒ‰ Hyperbridge**: Cross-chain data and asset bridging

### âš¡ **EVM Ecosystem Support**
- **ğŸ”· Multi-Chain**: Arbitrum, Base, BSC, Polygon, Celo, Flow
- **ğŸ¦ DeFi Protocols**: AAVE, Uniswap V3, Morpho, Fluid
- **ğŸ” Account Abstraction**: Gasless transactions via ZeroDev
- **ğŸ¯ Strategy Execution**: Automated DeFi operations

### ğŸ¤– **AI-Powered Agent Features**
- **ğŸ§  Natural Language Processing**: Chat with your DeFi agent
- **ğŸ“Š Cross-Chain Analytics**: Real-time data from multiple networks
- **ğŸ¯ Risk Assessment**: AI-driven portfolio optimization
- **ğŸ”„ Autonomous Execution**: Set-and-forget strategy management
- **ğŸ“ˆ Performance Tracking**: Multi-chain portfolio monitoring

## ğŸ† **Polkadot Hackathon Highlights**

### ğŸŒŸ **What Makes DynaVest Special**

**DynaVest is the first truly cross-chain DeFi Agent** that bridges Polkadot and EVM ecosystems through intelligent automation:

#### ğŸ”— **Cross-Chain Agent Architecture**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DynaVest DeFi Agent                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  ğŸ¤– AI Chat Interface                          â”‚
â”‚        "Find me the best staking opportunities"                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  ğŸ§  Agent Intelligence                         â”‚
â”‚  â€¢ Cross-chain data analysis  â€¢ Risk assessment                â”‚
â”‚  â€¢ Strategy optimization      â€¢ Portfolio rebalancing          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    ğŸ”— Polkadot Ecosystem     â”‚    âš¡ EVM Ecosystems           â”‚
â”‚  â€¢ Acala Liquid Staking      â”‚  â€¢ AAVE Lending                â”‚
â”‚  â€¢ Bifrost vDOT             â”‚  â€¢ Uniswap V3 LP               â”‚
â”‚  â€¢ HydraDX Omnipool         â”‚  â€¢ Account Abstraction         â”‚
â”‚  â€¢ ink! Smart Contracts      â”‚  â€¢ Multi-chain Execution       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  ğŸŒ‰ Hyperbridge Integration                    â”‚
â”‚        Cross-chain data & asset bridging                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  ğŸ“Š Unified Portfolio View                     â”‚
â”‚    Real-time tracking across all chains and protocols          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ğŸš€ **Key Innovation: Polkadot-First DeFi Agent**
- **Native Substrate Integration**: Direct parachain interactions
- **ink! Smart Contracts**: Rust-based strategy storage on Polkadot
- **Cross-Chain Intelligence**: AI that understands both Polkadot and EVM
- **Unified User Experience**: Single interface for all DeFi operations
- **Autonomous Execution**: Set strategies once, execute across chains

#### ğŸ¯ **Real-World Use Cases**

**For Polkadot Users:**
- Ask: *"What's the best DOT staking strategy?"*
- Agent: Analyzes Acala, Bifrost, and native staking
- Result: Automated liquid staking with optimal APY

**For EVM Users:**
- Ask: *"Find me high-yield lending opportunities"*
- Agent: Scans AAVE, Morpho, Fluid across chains
- Result: Automated lending with risk management

**For Cross-Chain Users:**
- Ask: *"Optimize my portfolio across all chains"*
- Agent: Analyzes Polkadot + EVM opportunities
- Result: Balanced portfolio with maximum yields

## ğŸ‰ Project Status: 100% Complete âœ…

**DynaVest is production-ready** with full functionality implemented and deployed:

### âœ… **Completed Features**
- **AI-Powered DeFi Chat Interface** - Natural language strategy interactions
- **Smart Wallet Integration** - Privy + ZeroDev account abstraction  
- **Strategy Persistence** - Complete ink! smart contracts for Polkadot
- **Cross-Chain Integration** - Hyperbridge-powered cross-chain LP data fetching
- **Mobile-First Design** - Responsive, accessible user experience
- **Backend API** - Full REST API with PostgreSQL integration
- **Live Deployment** - Production-ready Shuttle.dev deployment
- **Investment Functionality** - Full strategy creation and investment tracking
- **Comprehensive Documentation** - Setup guides, API docs, UX writeups

### ğŸ”§ **Deployment Status**
- **Frontend**: âœ… Ready for Vercel/Netlify deployment
- **Backend**: âœ… Live on Shuttle.dev (https://dynavest-ukdc.shuttle.app)
- **Smart Contracts**: âœ… ink! contracts compiled and tested
- **Database**: âœ… PostgreSQL with automated migrations
- **Cross-Chain**: âœ… Hyperbridge integration for external chain data

**The project is fully functional and ready for users.** All core features are implemented, tested, and deployed.

## âœ¨ Features

- **ğŸ¤– AI-Powered Chat Interface**: Conversational bot for DeFi strategy guidance
- **ğŸŒ Multi-Chain Support**: Deploy strategies across Arbitrum, Base, BSC, Celo, Polygon, and Flow
- **ğŸŒ‰ Cross-Chain Data Integration**: Real-time LP data from Ethereum/Uniswap via Hyperbridge
- **ğŸ“Š Risk Management**: Intelligent risk assessment and portfolio optimization with cross-chain analytics
- **ğŸ”’ Smart Wallet Integration**: Seamless authentication with Privy and ZeroDev
- **ğŸ’° Diverse DeFi Strategies**: AAVE lending, Uniswap liquidity provision, liquid staking, and more
- **ğŸ“ˆ Real-time Portfolio Tracking**: Live balance updates and performance analytics
- **ğŸ¯ Strategy Automation**: AI-driven strategy selection and execution
- **ğŸ’ Investment Tracking**: Complete strategy creation, funding, and performance monitoring
- **âš¡ Live API**: Production-ready backend with PostgreSQL persistence

## ğŸ› ï¸ Tech Stack

### Frontend
- **Framework**: Next.js 15, TypeScript, Tailwind CSS, Radix UI
- **Blockchain**: Wagmi, Viem, Privy, ZeroDev
- **State Management**: React Query, React Hook Form
- **Package Manager**: pnpm (required)

### Backend & Smart Contracts
- **Backend**: Shuttle.dev with Rust (Axum framework) + Docker alternative
- **Database**: PostgreSQL (provided by Shuttle or Docker)
- **Smart Contracts**: ink! (Rust-based contracts for Polkadot)
- **Cross-Chain**: Hyperbridge SDK for cross-chain LP data fetching
- **Blockchain**: Polkadot/Moonbeam network integration
- **External APIs**: Uniswap V3 subgraph integration via The Graph
- **Deployment**: Live on Shuttle.dev (https://dynavest-ukdc.shuttle.app)

## ğŸš€ Quick Start

### Prerequisites

- **Node.js 18+** (for frontend development)
- **pnpm** (required - see [Why pnpm?](#why-pnpm))
- **Rust** (for smart contracts and backend development)
- **cargo-contract** (for ink! smart contract compilation)
- **Shuttle CLI** (for backend deployment)

### Installation

#### Frontend Setup

1. **Clone the repository**
   ```bash
   git clone https://github.com/agentic-hack.git
   cd DynaVest
   ```

2. **Install dependencies**
   ```bash
   pnpm install
   ```

3. **Set up environment variables**
   ```bash
   cp .env.example .env.local
   ```
   Configure the required environment variables in `.env.local` (see [Environment Configuration](#-environment-configuration))

4. **Start the development server**
   ```bash
   pnpm run dev
   ```

5. **Open your browser**
   Navigate to [http://localhost:3000](http://localhost:3000)

#### Smart Contract Setup

1. **Install Rust** (if not already installed)
   ```bash
   curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
   source ~/.bashrc
   ```

2. **Install ink! CLI**
   ```bash
   cargo install cargo-contract --force
   rustup target add wasm32-unknown-unknown
   ```

3. **Build the smart contract**
   ```bash
   cd contracts/dynavest_basic
   cargo contract build --release
   ```

4. **Run contract tests**
   ```bash
   cargo test
   ```

5. **Deploy to Moonbeam** (optional)
   ```bash
   # Deploy using cargo-contract
   cargo contract instantiate --constructor new --suri //Alice --salt $(date +%s)
   ```

#### Backend Setup

You have multiple options for running the backend:

##### Option 1: Docker Deployment (Recommended for local development)

1. **Install Docker**
   ```bash
   # Install Docker and docker-compose
   docker --version
   docker-compose --version
   ```

2. **Deploy with one command**
   ```bash
   ./deploy-standalone.sh
   ```

3. **Verify deployment**
   ```bash
   curl http://localhost:8000/health
   # Should return: {"success":true,"data":"DynaVest Backend is running! ğŸš€","error":null}
   ```

##### Option 2: Shuttle.dev Deployment (Live Production)

**The backend is already live at:** https://dynavest-ukdc.shuttle.app

1. **Test the live API**
   ```bash
   curl https://dynavest-ukdc.shuttle.app/health
   # Should return: {"success":true,"data":"DynaVest Shuttle Backend is running!","error":null}
   ```

2. **Test cross-chain functionality**
   ```bash
   curl https://dynavest-ukdc.shuttle.app/cross-chain/opportunities/5
   # Returns cross-chain LP opportunities for risk level 5
   ```

3. **For local development:**
   ```bash
   cd shuttle-backend
   shuttle run
   ```

4. **To deploy your own instance:**
   ```bash
   cd shuttle-backend
   shuttle deploy
   ```

### Available Scripts

#### Frontend Scripts
- `pnpm run dev` - Start development server
- `pnpm run build` - Build for production
- `pnpm run start` - Start production server
- `pnpm run lint` - Run ESLint

#### Smart Contract Scripts
- `cargo contract build --release` - Build the ink! contract
- `cargo test` - Run contract tests
- `cargo contract instantiate` - Deploy to Moonbeam network

#### Backend Scripts
- `cargo run` - Start local development server
- `cargo test` - Run backend tests
- `shuttle run` - Start Shuttle development server
- `shuttle deploy` - Deploy to Shuttle.dev
- `curl https://dynavest-ukdc.shuttle.app/health` - Test live API

## ğŸŒŸ DeFi Strategies Available

### Lending Strategies
- **AAVE Supply**: Earn interest by supplying stablecoins (USDC, cEUR) to AAVE
- **Morpho Supply**: Optimized lending through Morpho protocol
- **Fluid Supply**: Lending through Fluid protocol

### Liquidity Provision
- **Uniswap V3**: Provide liquidity to trading pairs and earn swap fees
- **Concentrated Liquidity**: Narrow range liquidity for higher yields

### Advanced Strategies
- **Liquid Staking**: Stake tokens while maintaining liquidity
- **Leverage/Looping**: Recursive lending and borrowing strategies
- **Multi-Strategy**: Diversified portfolio approach

### ğŸ”— **Polkadot Ecosystem Strategies**
- **ğŸ¦€ Acala Liquid Staking**: Stake DOT â†’ LDOT with 10% APY while maintaining liquidity
- **ğŸŒŠ Bifrost vDOT**: Flexible liquid staking with 10.87% APR and cross-chain support
- **ğŸ”„ HydraDX Omnipool**: Low-slippage AMM trading with 5-15% LP yields
- **ğŸ’ DOT Native Staking**: Direct network staking with validator selection
- **ğŸŒ‰ Cross-Chain Bridging**: Hyperbridge integration for asset bridging
- **ğŸ“Š Polkadot Analytics**: Real-time parachain data and yield opportunities

### âš¡ **EVM Ecosystem Strategies**
- **ğŸ¦ AAVE Lending**: Multi-chain lending across Arbitrum, Base, BSC, Polygon
- **ğŸ”· Uniswap V3 LP**: Concentrated liquidity provision with optimal range management
- **ğŸ¯ Morpho Optimization**: Enhanced lending yields through protocol optimization
- **ğŸ’§ Fluid Protocol**: Next-gen lending with dynamic interest rates
- **ğŸ” Account Abstraction**: Gasless transactions via ZeroDev smart wallets
- **ğŸŒ Multi-Chain Execution**: Simultaneous strategy execution across chains

## ğŸŒ Supported Networks

| Network | Protocols Available | Strategy Storage |
|---------|-------------------|------------------|
| Arbitrum | AAVE, Uniswap V3 | âœ… Via Polkadot |
| Base | Morpho, AAVE, Uniswap V3 | âœ… Via Polkadot |
| BSC | AAVE, Uniswap V3 | âœ… Via Polkadot |
| Celo | Uniswap V3, AAVE (cEUR) | âœ… Via Polkadot |
| Polygon | AAVE | âœ… Via Polkadot |
| Flow | Kitty Protocol | âœ… Via Polkadot |
| **Moonbeam** | **ink! Contracts** | **âœ… Native Storage** |

## ğŸ“Š Smart Contract Deployments

### Celo Network (DeFi Strategies)
- **Executor**: [0x2a386fb9e19d201a1daf875fcd5c934c06265b65](https://celoscan.io/address/0x2a386fb9e19d201a1daf875fcd5c934c06265b65)
- **LiquidityRouter**: [0xfcfc4d0a0d6be5f2f8b7ffb77c1d9eebde97c977](https://celoscan.io/address/0xfcfc4d0a0d6be5f2f8b7ffb77c1d9eebde97c977)

### Moonbeam Network (Strategy Storage)
- **Strategy Manager**: Deploy your own ink! contract following the [deployment guide](contracts/strategy_manager/README.md)
- **Contract Features**:
  - Save and retrieve DeFi strategies
  - Risk level management (1-10 scale)
  - Strategy ownership and permissions
  - Event-driven architecture
  - Gas-optimized operations

### Backend API
- **Live Production API**: https://dynavest-ukdc.shuttle.app
- **API Features**:
  - RESTful endpoints for strategy management
  - Cross-chain LP data fetching via Hyperbridge
  - PostgreSQL database integration
  - Smart contract interaction layer
  - CORS enabled for frontend access
  - Rate limiting and security features
  - Health monitoring and logging
- **New Cross-Chain Endpoints**:
  - `POST /cross-chain/strategy` - Generate cross-chain strategy recommendations
  - `GET /cross-chain/opportunities/:risk_level` - Get cross-chain LP opportunities
  - `GET /strategies/:account` - Get user strategies
  - `POST /strategies` - Create new strategy
  - `GET /health` - API health check

### Contract Code Repository
- **Frontend & Strategy Logic**: [github.com/LI-YONG-QI/agentic-hack](https://github.com/LI-YONG-QI/agentic-hack)
- **ink! Smart Contract**: [contracts/dynavest_basic](contracts/dynavest_basic/)
- **Shuttle Backend**: [shuttle-backend](shuttle-backend/)
- **Setup Documentation**: [SETUP.md](SETUP.md)

## ğŸ”§ Why pnpm?

This project enforces the use of pnpm through a preinstall script. This ensures:
- **Consistent dependencies**: All developers use the same package manager
- **Faster installs**: pnpm's efficient dependency management
- **Disk space optimization**: Shared dependency storage
- **Lock file consistency**: Prevents conflicts between npm/yarn/pnpm lock files

If you try to use npm or yarn, the installation will fail with an error message directing you to use pnpm.

## ğŸ—ï¸ Technical Architecture

### Application Architecture Overview

DynaVest follows a modern full-stack architecture with clear separation of concerns:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Next.js Frontend                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  UI Layer (React Components + Tailwind CSS)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Context Layer (State Management)                          â”‚
â”‚  â€¢ AssetsContext  â€¢ ChatContext  â€¢ AuthContext            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Hooks Layer (Business Logic)                              â”‚
â”‚  â€¢ useAssets  â€¢ useStrategy  â€¢ useBalance  â€¢ useChat      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Service Layer                                             â”‚
â”‚  â€¢ Blockchain Services  â€¢ API Services  â€¢ AI Services     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Shuttle.dev Backend                      â”‚
â”‚  â€¢ Rust/Axum API  â€¢ PostgreSQL  â€¢ Strategy Management     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   Polkadot/Moonbeam                        â”‚
â”‚  â€¢ ink! Smart Contracts  â€¢ Strategy Storage  â€¢ Events     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  External Integrations                                     â”‚
â”‚  â€¢ Privy (Auth)  â€¢ Wagmi (Blockchain)  â€¢ DeFi Protocols   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Core Architecture Patterns

#### 1. **Component Architecture**
```typescript
// Hierarchical component structure
RootLayout
â”œâ”€â”€ Providers (Auth, Query, Wagmi)
â”œâ”€â”€ Header (Navigation + Wallet)
â”œâ”€â”€ MainContent
â”‚   â”œâ”€â”€ StrategyList (DeFi Strategies)
â”‚   â”œâ”€â”€ Profile (Portfolio Management)
â”‚   â””â”€â”€ Chat (AI Assistant)
â”œâ”€â”€ BottomNav (Mobile Navigation)
â””â”€â”€ OnboardingGate (First-time Users)
```

#### 2. **State Management Pattern**
```typescript
// Context-based state management
PrivyProvider (Authentication)
â”œâ”€â”€ SmartWalletsProvider (Wallet Management)
â”œâ”€â”€ QueryClientProvider (Data Fetching)
â”œâ”€â”€ WagmiProvider (Blockchain Interactions)
â”œâ”€â”€ AssetsProvider (Asset Management)
â””â”€â”€ ChatProvider (AI Chat Functionality)
```

#### 3. **Strategy Pattern Implementation**
```typescript
// Abstract strategy pattern for DeFi protocols
abstract class BaseStrategy<T extends Protocol> {
  abstract investCalls(): Promise<StrategyCall[]>
  abstract redeemCalls(): Promise<StrategyCall[]>
  abstract getProfit(): Promise<number>
}

// Strategy implementations
class AAVEStrategy extends BaseStrategy<AAVE> { ... }
class UniswapStrategy extends BaseStrategy<Uniswap> { ... }
class MorphoStrategy extends BaseStrategy<Morpho> { ... }
```

#### 4. **Data Flow Architecture**
```
User Input â†’ UI Components â†’ Custom Hooks â†’ Context Providers â†’ Shuttle API â†’ ink! Contracts
                                                             â†“                      â†“
External APIs â† Backend Services â† PostgreSQL Database â† Strategy Storage â† Moonbeam Network
```

### Project Structure

```
DynaVest/
â”œâ”€â”€ src/                       # Frontend source code
â”‚   â”œâ”€â”€ app/                   # Next.js App Router pages
â”‚   â”‚   â”œâ”€â”€ layout.tsx         # Root layout with providers
â”‚   â”‚   â”œâ”€â”€ page.tsx           # Homepage
â”‚   â”‚   â””â”€â”€ globals.css        # Global styles
â”‚   â”œâ”€â”€ components/            # Reusable UI components
â”‚   â”‚   â”œâ”€â”€ ui/               # Shadcn/ui components
â”‚   â”‚   â”œâ”€â”€ Header.tsx        # Navigation header
â”‚   â”‚   â”œâ”€â”€ BottomNav.tsx     # Mobile navigation
â”‚   â”‚   â”œâ”€â”€ Chatroom.tsx      # AI chat interface
â”‚   â”‚   â”œâ”€â”€ StrategyList.tsx  # Strategy browsing
â”‚   â”‚   â””â”€â”€ SavedStrategiesList.tsx  # Saved strategies
â”‚   â”œâ”€â”€ contexts/              # React Context providers
â”‚   â”‚   â”œâ”€â”€ AssetsContext/    # Asset and portfolio state
â”‚   â”‚   â””â”€â”€ ChatContext.tsx   # Chat functionality
â”‚   â”œâ”€â”€ hooks/                 # Custom React hooks
â”‚   â”‚   â”œâ”€â”€ useAssets.ts      # Asset management
â”‚   â”‚   â”œâ”€â”€ useStrategy.ts    # Strategy execution
â”‚   â”‚   â””â”€â”€ useBalance.ts     # Balance queries
â”‚   â”œâ”€â”€ classes/               # Business logic classes
â”‚   â”‚   â”œâ”€â”€ strategies/       # DeFi strategy implementations
â”‚   â”‚   â””â”€â”€ protocols/        # Protocol integrations
â”‚   â”œâ”€â”€ constants/             # Configuration constants
â”‚   â”œâ”€â”€ types/                 # TypeScript definitions
â”‚   â”œâ”€â”€ utils/                 # Utility functions
â”‚   â”‚   â”œâ”€â”€ strategyApi.ts    # API client for strategies
â”‚   â”‚   â””â”€â”€ toast.ts          # Toast notifications
â”‚   â””â”€â”€ providers/             # External service providers
â”œâ”€â”€ contracts/                 # Smart contract code
â”‚   â””â”€â”€ dynavest_basic/        # ink! contract for strategy storage
â”‚       â”œâ”€â”€ lib.rs            # Contract implementation
â”‚       â””â”€â”€ Cargo.toml        # Rust dependencies
â”œâ”€â”€ shuttle-backend/           # Backend API service
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.rs           # Main API server
â”‚   â”‚   â””â”€â”€ hyperbridge.rs    # Cross-chain integration
â”‚   â”œâ”€â”€ Cargo.toml            # Rust dependencies
â”‚   â””â”€â”€ Shuttle.toml          # Shuttle configuration
â”œâ”€â”€ docs/                      # Documentation
â”‚   â”œâ”€â”€ plan.md               # Project plan and status
â”‚   â””â”€â”€ SETUP.md              # Comprehensive setup guide
â”œâ”€â”€ public/                    # Static assets
â”œâ”€â”€ .env                       # Environment variables
â”œâ”€â”€ package.json              # Dependencies and scripts
â”œâ”€â”€ tailwind.config.js        # Tailwind CSS configuration
â”œâ”€â”€ tsconfig.json             # TypeScript configuration
â””â”€â”€ next.config.ts            # Next.js configuration
```

### Key Architectural Decisions

1. **Next.js App Router**: Modern routing with server components
2. **TypeScript**: Type-safe development with comprehensive type definitions
3. **Context + Hooks**: Scalable state management without external libraries
4. **Abstract Strategy Pattern**: Extensible DeFi protocol integrations
5. **React Query**: Efficient data fetching and caching
6. **Account Abstraction**: Simplified UX with smart wallets
7. **Multi-chain Architecture**: Cross-chain DeFi strategy execution
8. **ink! Smart Contracts**: Rust-based contracts for Polkadot integration
9. **Shuttle.dev Backend**: Serverless Rust API for scalable backend services
10. **PostgreSQL**: Reliable database for strategy persistence and analytics

## ğŸ”§ Environment Configuration

### Required Environment Variables

Create a `.env.local` file with the following variables:

```bash
# Privy Authentication (Required)
NEXT_PUBLIC_PRIVY_APP_ID=your_privy_app_id
NEXT_PUBLIC_PRIVY_CLIENT_ID=your_privy_client_id

# Alchemy API (Required for blockchain interactions)
NEXT_PUBLIC_ALCHEMY_API_KEY=your_alchemy_api_url

# WalletConnect (Required for external wallet connections)
NEXT_PUBLIC_WALLETCONNECT_PROJECT_ID=your_walletconnect_project_id

# Shuttle Backend API (Required for strategy storage)
NEXT_PUBLIC_SHUTTLE_API_URL=https://dynavest-ukdc.shuttle.app

# Admin Configuration (Optional - for admin functions)
ADMIN_PRIVATE_KEY=your_admin_private_key

# Wallet Configuration (Optional - for specific wallet operations)
WALLET_KEY=your_wallet_private_key
WALLET_ADDRESS=your_wallet_address

# RPC Configuration (Optional - custom RPC endpoint)
RPC_URL=your_custom_rpc_url

# Development Portal Key (Optional - for development features)
DEV_PORTAL_KEY=your_dev_portal_key
```

### Configuration Details

#### 1. **Privy Authentication Setup**
```bash
# Get these from https://dashboard.privy.io/
NEXT_PUBLIC_PRIVY_APP_ID=
NEXT_PUBLIC_PRIVY_CLIENT_ID=
```

**How to get Privy credentials:**
1. Sign up at [Privy Dashboard](https://dashboard.privy.io/)
2. Create a new app
3. Configure authentication methods (Google, Wallet, etc.)
4. Copy the App ID and Client ID

#### 2. **Alchemy API Configuration**
```bash
# Get from https://dashboard.alchemy.com/
NEXT_PUBLIC_ALCHEMY_API_KEY=https://eth-mainnet.g.alchemy.com/v2/YOUR_API_KEY
```

**How to get Alchemy API key:**
1. Sign up at [Alchemy](https://dashboard.alchemy.com/)
2. Create a new app
3. Select the networks you need (Ethereum, Polygon, Arbitrum, etc.)
4. Copy the API URL

#### 3. **Optional Configuration**

**Admin Private Key** (for admin operations):
```bash
ADMIN_PRIVATE_KEY=0x1234567890abcdef...
```

**Wallet Configuration** (for specific wallet operations):
```bash
WALLET_KEY=0x1234567890abcdef...
WALLET_ADDRESS=0x1234567890123456789012345678901234567890
```

**Custom RPC URL** (for custom blockchain endpoints):
```bash
RPC_URL=https://your-custom-rpc-endpoint.com
```

### Environment Setup Steps

1. **Copy the environment file:**
   ```bash
   cp .env.example .env.local
   ```

2. **Configure required variables:**
   - Set up Privy authentication
   - Configure Alchemy API access
   - Add optional variables as needed

3. **Verify configuration:**
   ```bash
   pnpm run dev
   ```

4. **Test authentication:**
   - Visit `http://localhost:3000`
   - Try logging in with Google or wallet
   - Check browser console for any configuration errors

### Security Notes

- **Never commit `.env.local` to version control**
- **Use environment-specific configurations for production**
- **Rotate API keys regularly**
- **Use read-only keys where possible**
- **Validate all environment variables on startup**

### Production Deployment

For production deployment (e.g., Vercel), set environment variables in your hosting platform:

1. **Vercel**: Project Settings â†’ Environment Variables
2. **Netlify**: Site Settings â†’ Environment Variables
3. **Railway**: Project Settings â†’ Variables

Make sure to set all required variables for your production environment.

## ğŸš€ Deployment Guide

### Quick Deployment (Recommended)

**Backend is already live!** You can start using the API immediately:

```bash
# 1. Test the live backend
curl https://dynavest-ukdc.shuttle.app/health

# 2. Start frontend (connects to live backend)
pnpm install
cp .env.example .env.local
# Edit .env.local with your API keys
pnpm run dev
```

### Complete Production Deployment

#### Option 1: Docker-based Deployment

1. **Deploy Backend with Docker**
   ```bash
   # Local deployment
   ./deploy-standalone.sh
   
   # Production deployment (Railway/Fly.io/Digital Ocean)
   # See docs/alternative-deployment.md for details
   ```

2. **Deploy Frontend**
   ```bash
   # Update .env.local with backend URL
   echo "NEXT_PUBLIC_SHUTTLE_API_URL=http://localhost:8000" >> .env.local
   
   # Deploy to Vercel
   pnpm run build
   vercel deploy
   ```

#### Option 2: Shuttle.dev Deployment

1. **Deploy Smart Contract**
   ```bash
   cd contracts/strategy_manager
   # Configure your deployment account in deploy.sh
   ./deploy.sh
   # Save the contract address for backend configuration
   ```

2. **Deploy Backend API**
   ```bash
   cd shuttle-backend
   # Set environment variables
   shuttle project env set CONTRACT_ADDRESS="your-contract-address"
   shuttle project env set RPC_URL="wss://moonbeam-alpha.api.onfinality.io/public-ws"
   ./deploy.sh
   # Save the API URL for frontend configuration
   ```

3. **Deploy Frontend**
   ```bash
   # Update .env.local with deployed backend URL
   echo "NEXT_PUBLIC_SHUTTLE_API_URL=https://your-app.shuttleapp.rs" >> .env.local
   
   # Deploy to Vercel
   pnpm run build
   vercel deploy
   ```

4. **Test the Integration**
   ```bash
   # Test the complete flow
   curl -X POST https://your-app.shuttleapp.rs/strategies \
     -H "Content-Type: application/json" \
     -d '{"account":"0x123","strategy":{"name":"Test","risk_level":5,"parameters":"{}"}}'
   ```

### Monitoring and Maintenance

- **Monitor contract events** on Moonbeam explorer
- **Check backend logs** via Shuttle dashboard
- **Monitor API usage** and performance metrics
- **Update contract address** if redeployed
- **Backup strategy data** regularly

## ğŸ¤ Contributing

1. Fork the repository
2. Create a feature branch: `git checkout -b feature/amazing-feature`
3. Commit your changes: `git commit -m 'Add amazing feature'`
4. Push to the branch: `git push origin feature/amazing-feature`
5. Open a Pull Request

## ğŸ“ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## ğŸ”— Links

- [Website](https://dynavest.app)
- [Documentation](https://docs.dynavest.app)
- [Discord](https://discord.gg/dynavest)
- [Twitter](https://twitter.com/dynavest)

## âš ï¸ Disclaimer

DynaVest is experimental software. DeFi investments carry inherent risks including but not limited to smart contract risks, market volatility, and potential loss of funds. Always do your own research and never invest more than you can afford to lose.
